/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

var y=Object.defineProperty;var O=Object.getOwnPropertyDescriptor;var H=Object.getOwnPropertyNames;var G=Object.prototype.hasOwnProperty;var W=(l,i)=>{for(var e in i)y(l,e,{get:i[e],enumerable:!0})},B=(l,i,e,t)=>{if(i&&typeof i=="object"||typeof i=="function")for(let n of H(i))!G.call(l,n)&&n!==e&&y(l,n,{get:()=>i[n],enumerable:!(t=O(i,n))||t.enumerable});return l};var z=l=>B(y({},"__esModule",{value:!0}),l);var j={};W(j,{default:()=>N});module.exports=z(j);var T=require("obsidian");var w=require("obsidian");var L={language:"Language",language_desc:"Select language",language_zh:"Chinese",language_en:"English",start_page:"Start page",welcome:"Welcome back \u{1F44B}",recent_notes:"\u{1F552}Recently notes",pinned_notes:"\u{1F4CC}Pinned notes",refresh:"Refresh",minutes_ago:"{minutes} minutes ago",hours_ago:"{hours} hours ago",days_ago:"{days} days ago",root_folder:"Root folder",start_page_settings:"Start page settings",recent_notes_limit:"Recent notes limit",recent_notes_limit_desc:"Set the number of recent modified notes to display on the start page",recent_notes_limit_placeholder:"Enter a number",pinned_notes_setting:"Pinned notes",pinned_notes_select:"Select notes",pinned_notes_select_desc:"Select notes to display on the start page",pinned_notes_remove:"Remove",current_pinned_notes:"Current pinned notes",show_count:"Show count",new_note:"New note",total_notes:"Total notes",today_edited:"Today edited",total_size:"Total size",manage:"Manage",replace_new_tab:"Replace new tab",replace_new_tab_desc:"When opening a new tab, replace it with Start Page",close_other_tabs_when_app_start:"Close other tabs when the app starts",close_other_tabs_when_app_start_desc:"Close all other tabs when the app starts",remove_from_pinned_notes:"Remove from pinned notes",add_to_pinned_notes:"Add to pinned notes",note_already_pinned:"Note already pinned",move_up:"Move up",move_down:"Move down",open_start_page:"Open start page",open_start_page_desc:"Open the start page in current tab",open_start_page_new_tab:"Open start page in new tab",open_start_page_new_tab_desc:"Open the start page in a new tab"};var P={language:"\u8BED\u8A00",language_desc:"\u9009\u62E9\u8BED\u8A00",language_zh:"\u4E2D\u6587",language_en:"\u82F1\u6587",start_page:"\u542F\u52A8\u9996\u9875",welcome:"\u6B22\u8FCE\u56DE\u6765\u{1F44B}",recent_notes:"\u{1F552}\u6700\u8FD1\u7B14\u8BB0",pinned_notes:"\u{1F4CC}\u7F6E\u9876\u7B14\u8BB0",refresh:"\u5237\u65B0",minutes_ago:"{minutes}\u5206\u949F\u524D",hours_ago:"{hours}\u5C0F\u65F6\u524D",days_ago:"{days}\u5929\u524D",root_folder:"\u7B14\u8BB0\u5E93",start_page_settings:"\u542F\u52A8\u9996\u9875\u8BBE\u7F6E",recent_notes_limit:"\u6700\u8FD1\u4FEE\u6539\u7B14\u8BB0\u663E\u793A\u6570\u91CF",recent_notes_limit_desc:"\u8BBE\u7F6E\u542F\u52A8\u9996\u9875\u663E\u793A\u7684\u6700\u8FD1\u4FEE\u6539\u7B14\u8BB0\u6570\u91CF",recent_notes_limit_placeholder:"\u8F93\u5165\u6570\u5B57",pinned_notes_setting:"\u7F6E\u9876\u7B14\u8BB0",pinned_notes_select:"\u9009\u62E9\u7B14\u8BB0",pinned_notes_select_desc:"\u9009\u62E9\u8981\u5728\u542F\u52A8\u9996\u9875\u7F6E\u9876\u663E\u793A\u7684\u7B14\u8BB0",pinned_notes_remove:"\u79FB\u9664",current_pinned_notes:"\u5F53\u524D\u7F6E\u9876\u7B14\u8BB0",show_count:"\u663E\u793A\u6570\u91CF",new_note:"\u65B0\u5EFA\u7B14\u8BB0",total_notes:"\u603B\u7B14\u8BB0\u6570",today_edited:"\u4ECA\u65E5\u7F16\u8F91",total_size:"\u603B\u5360\u7528\u7A7A\u95F4",manage:"\u7BA1\u7406",replace_new_tab:"\u66FF\u6362\u65B0\u6807\u7B7E\u9875",replace_new_tab_desc:"\u6253\u5F00\u65B0\u6807\u7B7E\u9875\u65F6\uFF0C\u4F7F\u7528\u542F\u52A8\u9996\u9875\u66FF\u6362\u9ED8\u8BA4\u7684\u65B0\u6807\u7B7E\u9875",close_other_tabs_when_app_start:"\u5173\u95ED\u5176\u4ED6\u6807\u7B7E\u9875\u5F53\u7A0B\u5E8F\u542F\u52A8\u65F6",close_other_tabs_when_app_start_desc:"\u5173\u95ED\u6240\u6709\u5176\u4ED6\u6807\u7B7E\u9875\u5F53\u7A0B\u5E8F\u542F\u52A8\u65F6",remove_from_pinned_notes:"\u4ECE\u7F6E\u9876\u7B14\u8BB0\u79FB\u9664",add_to_pinned_notes:"\u6DFB\u52A0\u5230\u7F6E\u9876\u7B14\u8BB0",note_already_pinned:"\u7B14\u8BB0\u5DF2\u7F6E\u9876",move_up:"\u4E0A\u79FB",move_down:"\u4E0B\u79FB",open_start_page:"\u6253\u5F00\u542F\u52A8\u9996\u9875",open_start_page_desc:"\u5728\u5F53\u524D\u6807\u7B7E\u9875\u6253\u5F00\u542F\u52A8\u9996\u9875",open_start_page_new_tab:"\u5728\u65B0\u6807\u7B7E\u9875\u6253\u5F00\u542F\u52A8\u9996\u9875",open_start_page_new_tab_desc:"\u5728\u65B0\u6807\u7B7E\u9875\u4E2D\u6253\u5F00\u542F\u52A8\u9996\u9875"};var k={en:L,zh:P},U="en",F=L;function R(l){k[l]&&(U=l,F=k[l])}function s(l){return F[l]||l}var m=require("obsidian");var A="totalNotes",M="todayEdited",x="totalSize",S=class{constructor(i,e,t){this.stats=[{id:A,data:{number:0,label:function(){return s("total_notes")},icon:[{tagName:"path",attributes:{d:"M14 2H6A2 2 0 0 0 4 4V20A2 2 0 0 0 6 22H18A2 2 0 0 0 20 20V8L14 2Z"}},{tagName:"path",attributes:{d:"M14 2V8H20"}}]}},{id:M,data:{number:0,label:function(){return s("today_edited")},icon:[{tagName:"path",attributes:{d:"M12 8V12L15 15"}},{tagName:"circle",attributes:{cx:12,cy:12,r:10,stroke:"currentColor","stroke-width":2}}]}},{id:x,data:{number:"0",label:function(){return s("total_size")},icon:[{tagName:"rect",attributes:{x:"3",y:"6",width:"18",height:"12",rx:"2",ry:"2",stroke:"currentColor","stroke-width":"2",fill:"none"}},{tagName:"circle",attributes:{cx:"7",cy:"12",r:"1",fill:"currentColor"}},{tagName:"path",attributes:{d:"M11 10H17",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round"}},{tagName:"path",attributes:{d:"M11 14H15",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round"}}]}}];this.pinnedNotes=null;this.recentNotes=null;this.app=i,this.plugin=e,this.container=t}createStartPage(i,e){this.initData(i,e),this.container.empty(),this.container.addClass("start-page-container");let t=this.createMainContent(),n=this.createFooter();if(m.Platform.isDesktop){let a=this.createHeader();this.container.appendChild(a)}this.container.appendChild(t),this.container.appendChild(n)}initData(i,e){this.pinnedNotes=i,this.recentNotes=e,this.stats.forEach(t=>{t.id===A?t.data.number=this.app.vault.getMarkdownFiles().length:t.id===M?t.data.number=this.getTodayModifiedNoteCount():t.id===x&&(t.data.number=this.formatSize(this.getTotalSize()))})}createHeader(){let i=this.createElement("header","header"),e=this.createElement("div","logo"),t=this.createSVG([{tagName:"path",attributes:{d:"M12 2L2 7L12 12L22 7L12 2Z","stroke-linecap":"none"}},{tagName:"path",attributes:{d:"M2 17L12 22L22 17","stroke-linecap":"none"}},{tagName:"path",attributes:{d:"M2 12L12 17L22 12","stroke-linecap":"none"}}],"logo-icon"),n=this.createElement("span","logo-text","Start Page for Obsidian");e.appendChild(t),e.appendChild(n);let a=this.createElement("div","header-actions"),o=this.createElement("button"),r=this.createSVG([{tagName:"path",attributes:{d:"M12 5V19"}},{tagName:"path",attributes:{d:"M5 12H19"}}],"new-note-icon");return o.addEventListener("click",async()=>{let p=this.app.fileManager.getNewFileParent("");if(!p){console.error("Unable to get the currently selected directory");return}let c=p.path==="/"?"Untitled.md":p.path+"/Untitled.md",_=1,u=this.app.vault.getAbstractFileByPath(c);for(;u;)c=p.path==="/"?`Untitled ${_++}.md`:p.path+`/Untitled ${_++}.md`,u=this.app.vault.getAbstractFileByPath(c);let h=await this.app.vault.create(c,"");this.app.workspace.openLinkText(h.path,"",!1)}),o.appendChild(r),o.appendChild(document.createTextNode(s("new_note"))),a.appendChild(o),i.appendChild(e),i.appendChild(a),i}createStatsSection(){let i=this.createElement("div","stats-section");return this.stats.forEach(e=>{let t=this.createElement("div","stat-card"),n=this.createElement("div","stat-icon"),a=this.createSVG(e.data.icon);n.appendChild(a);let o=this.createElement("div","stat-content"),r=this.createElement("div","stat-number",e.data.number.toString()),p=this.createElement("div","stat-label",e.data.label());o.appendChild(r),o.appendChild(p),t.appendChild(n),t.appendChild(o),i.appendChild(t)}),i}createNoteItem(i,e=!1){if(!i)return null;let t=this.createElement("div",`note-item${e?" pinned":""}`);t.addEventListener("click",async()=>{let h=this.app.workspace.getLeavesOfType("markdown").find(v=>v.view.getState().file===i.path);h?await this.app.workspace.revealLeaf(h):this.app.workspace.openLinkText(i.path,"",!1)}),e&&t.addEventListener("contextmenu",h=>{h.preventDefault(),h.stopPropagation();let v=new m.Menu;v.addItem(E=>{E.setTitle(s("remove_from_pinned_notes")).setIcon("pin-off").onClick(async()=>{this.plugin.settings.pinnedNotes=this.plugin.settings.pinnedNotes.filter(V=>V!==i.path),await this.plugin.saveSettings(),this.refreshStartPage()})}),v.showAtMouseEvent(h)}),e||t.addEventListener("contextmenu",h=>{h.preventDefault(),h.stopPropagation();let v=new m.Menu;v.addItem(E=>{E.setTitle(s("add_to_pinned_notes")).setIcon("pin").onClick(async()=>{if(this.plugin.settings.pinnedNotes.includes(i.path)){new m.Notice(s("note_already_pinned"));return}this.plugin.settings.pinnedNotes.push(i.path),await this.plugin.saveSettings(),this.refreshStartPage()})}),v.showAtMouseEvent(h)});let n=this.createElement("div","note-content"),a=this.createElement("div","note-title",i.basename),o=this.formatDate(i.stat.mtime),r=this.createElement("div","note-meta",o),p=i.parent?i.parent.name:"";p=p||"/";let c=this.createSVG([{tagName:"path",attributes:{d:"M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5l2 3h9a2 2 0 0 1 2 2z"}}],"folder-icon");c.setAttribute("width","16"),c.setAttribute("height","16");let _=document.createTextNode(` ${p}`),u=this.createElement("div","note-path");return u.appendChild(c),u.appendChild(_),r.appendChild(u),a.setAttribute("title",i.basename),n.appendChild(a),this.addContentPreview(n,i,e),n.appendChild(r),t.appendChild(n),t}async addContentPreview(i,e,t){try{let n=await this.app.vault.cachedRead(e),a=this.extractPreviewText(n,t);if(a.trim()){let o=this.createElement("div","note-preview",a),r=i.querySelector(".note-meta");r?i.insertBefore(o,r):i.appendChild(o)}}catch(n){console.warn(`Failed to read content for ${e.path}:`,n)}}extractPreviewText(i,e){let t=i.replace(/^#+\s+/gm,"").replace(/\*\*(.*?)\*\*/g,"$1").replace(/\*(.*?)\*/g,"$1").replace(/\[([^\]]+)\]\([^)]+\)/g,"$1").replace(/!\[([^\]]*)\]\([^)]+\)/g,"").replace(/```[\s\S]*?```/g,"").replace(/`([^`]+)`/g,"$1").replace(/^\s*[-*+]\s+/gm,"").replace(/^\s*\d+\.\s+/gm,"").replace(/^\s*>\s+/gm,"").replace(/\n\s*\n/g,`
`).trim();return t?t.split(`
`).filter(a=>a.trim()).join(`
`):""}createNotesSection(i,e,t=!1,n=[]){let a=this.createElement("section","section"),o=this.createElement("div","section-header"),r=this.createElement("h2","section-title");if(n.length){let c=this.createSVG(n,"section-icon");r.appendChild(c)}if(r.appendChild(document.createTextNode(i)),t)o.appendChild(r);else{let c=this.createRecentNotesLimitDropdown();o.appendChild(r),o.appendChild(c)}let p=this.createElement("div","notes-list");return e&&e.forEach(c=>{let _=this.createNoteItem(c,t);if(_&&(p.appendChild(_),c!==e[e.length-1])){let u=this.createElement("div","section-divider");p.appendChild(u)}}),a.appendChild(o),a.appendChild(p),a}createContentGrid(){let i=this.createElement("div","content-grid"),e=this.createNotesSection(s("pinned_notes"),this.pinnedNotes,!0,[]);e.classList.add("pinned-notes");let t=this.createNotesSection(s("recent_notes"),this.recentNotes,!1,[]);return t.classList.add("recent-notes"),i.appendChild(e),i.appendChild(t),i}createMainContent(){let i=this.createElement("main","main-content");if(m.Platform.isDesktop){let t=this.createStatsSection();i.appendChild(t)}let e=this.createContentGrid();return i.appendChild(e),i}createFooter(){let i=this.createElement("footer","footer"),e=this.createElement("p","","\u2764\uFE0F Love what you love, and love what you do. \u2764\uFE0F");return i.appendChild(e),i}createSVG(i,e=null){let t=document.createElementNS("http://www.w3.org/2000/svg","svg");return t.setAttribute("viewBox","0 0 24 24"),t.setAttribute("fill","none"),t.setAttribute("xmlns","http://www.w3.org/2000/svg"),e&&t.setAttribute("class",e),i.forEach(n=>{let a=document.createElementNS("http://www.w3.org/2000/svg",n.tagName);n.tagName==="path"&&!n.attributes.fill&&(n.attributes.stroke=n.attributes.stroke||"currentColor",n.attributes["stroke-width"]=n.attributes["stroke-width"]||"2",n.attributes["stroke-linecap"]=n.attributes["stroke-linecap"]||"round",n.attributes["stroke-linejoin"]=n.attributes["stroke-linejoin"]||"round");for(let[o,r]of Object.entries(n.attributes))r!==void 0&&(typeof r=="number"&&(r=r.toString()),a.setAttribute(o,r));t.appendChild(a)}),t}createElement(i,e="",t=""){let n=document.createElement(i);return e&&(n.className=e),t&&(n.textContent=t),n}refreshStartPage(){this.app.workspace.getLeavesOfType(d).forEach(e=>{if(e.view instanceof g){e.view.renderContent();return}})}createRecentNotesLimitDropdown(){let i=document.createElement("select");for(let n=5;n<=50;n+=5){let a=document.createElement("option");a.value=n.toString(),a.textContent=n.toString(),i.appendChild(a),n===this.plugin.settings.recentNotesLimit&&(a.selected=!0)}i.addEventListener("change",()=>{let n=parseInt(i.value,10);this.plugin.settings.recentNotesLimit=n,this.plugin.saveSettings(),this.refreshStartPage()});let e=document.createElement("label");e.className="recent-notes-limit-label",e.textContent=s("show_count"),e.htmlFor=i.id;let t=document.createElement("div");return t.appendChild(e),t.appendChild(i),t}getTodayModifiedNoteCount(){let i=new Date;return i.setHours(0,0,0,0),this.app.vault.getMarkdownFiles().filter(n=>n.stat.mtime>=i.getTime()).length}getTotalSize(){let i=this.app.vault.getMarkdownFiles(),e=0;return i.forEach(t=>{e+=t.stat.size}),e}formatDate(i){let e=new Date(i),t=new Date,n=t.getTime()-e.getTime();if(n<24*60*60*1e3)return e.toLocaleTimeString("zh-CN",{hour:"2-digit",minute:"2-digit",second:"2-digit"});if(n<7*24*60*60*1e3){let a=Math.floor(n/864e5);return s("days_ago").replace("{days}",a.toString())}return e.getFullYear()===t.getFullYear()?`${(e.getMonth()+1).toString().padStart(2,"0")}/${e.getDate().toString().padStart(2,"0")}`:e.toLocaleDateString("zh-CN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"})}formatSize(i){return i<1024?i+"B":i<1024*1024?(i/1024).toFixed(0)+"KB":i<1024*1024*1024?(i/(1024*1024)).toFixed(0)+"MB":(i/(1024*1024*1024)).toFixed(0)+"GB"}};var d="start-page-view",g=class extends w.ItemView{constructor(e,t,n){super(e);this.refreshTimer=null;this.REFRESH_INTERVAL=6e4;this.app=t,this.plugin=n,this.navigation=!0,this.icon="home",this.contentEl.addClass("start-page-view")}getViewType(){return d}getDisplayText(){return s("start_page")}getIcon(){return"home"}canClose(){return!0}async onOpen(){await this.renderContent(),this.fileChangeEventRef=this.app.vault.on("modify",()=>{this.renderContent()}),this.fileCreateEventRef=this.app.vault.on("create",()=>{this.renderContent()}),this.fileDeleteEventRef=this.app.vault.on("delete",()=>{this.renderContent()}),this.fileRenameEventRef=this.app.vault.on("rename",()=>{this.renderContent()}),this.registerDomEvent(this.containerEl,"contextmenu",e=>{let t=new w.Menu;t.addItem(n=>{n.setTitle(s("refresh")).setIcon("refresh-cw").onClick(()=>this.renderContent())}),t.showAtPosition({x:e.clientX,y:e.clientY})})}async onClose(){this.fileChangeEventRef&&this.app.vault.offref(this.fileChangeEventRef),this.fileCreateEventRef&&this.app.vault.offref(this.fileCreateEventRef),this.fileDeleteEventRef&&this.app.vault.offref(this.fileDeleteEventRef),this.fileRenameEventRef&&this.app.vault.offref(this.fileRenameEventRef),this.clearRefreshTimer()}clearRefreshTimer(){this.refreshTimer!==null&&(window.clearInterval(this.refreshTimer),this.refreshTimer=null)}startRefreshTimerIfNeeded(e,t){this.clearRefreshTimer(),e.concat(t).some(a=>Date.now()-a.stat.mtime<24*60*60*1e3)&&(this.refreshTimer=window.setInterval(()=>{this.renderContent()},this.REFRESH_INTERVAL))}async renderContent(){let e=this.containerEl.children[1];this.startPageCreator||(this.startPageCreator=new S(this.app,this.plugin,e));let t=this.getTFiles(this.plugin.settings.pinnedNotes),n=this.getRecentNotes(this.plugin.settings.recentNotesLimit);this.startPageCreator.createStartPage(t,n),this.startRefreshTimerIfNeeded(t,n)}getTFiles(e){return e?e.map(n=>{let a=this.app.vault.getAbstractFileByPath(n);return a instanceof w.TFile?a:null}).filter(n=>n!==null):[]}getRecentNotes(e){return this.app.vault.getMarkdownFiles().sort((n,a)=>a.stat.mtime-n.stat.mtime).slice(0,e).map(n=>n)}};var f=require("obsidian");var I=require("obsidian"),b=class extends I.SuggestModal{constructor(e,t){super(e);this.onChooseItem=t}getSuggestions(e){return this.app.vault.getMarkdownFiles().filter(t=>t.path.toLowerCase().includes(e.toLowerCase()))}renderSuggestion(e,t){t.setText(e.path)}onChooseSuggestion(e,t){this.onChooseItem(e)}};var D={recentNotesLimit:20,pinnedNotes:[],replaceNewTab:!0,closeOtherTabsWhenAppStart:!0},C=class extends f.PluginSettingTab{constructor(e,t){super(e,t);this.plugin=t}refreshStartPage(){this.app.workspace.getLeavesOfType(d).forEach(t=>{t.view instanceof g&&t.view.renderContent()})}async moveNote(e,t){let n=[...this.plugin.settings.pinnedNotes],[a]=n.splice(e,1);n.splice(t,0,a),this.plugin.settings.pinnedNotes=n,await this.plugin.saveSettings(),this.refreshStartPage(),this.display()}display(){let{containerEl:e}=this;if(e.empty(),new f.Setting(e).setName(s("recent_notes_limit")).setDesc(s("recent_notes_limit_desc")).addDropdown(t=>{for(let n=5;n<=50;n+=5)t.addOption(n.toString(),n.toString());t.setValue(this.plugin.settings.recentNotesLimit.toString()),t.onChange(async n=>{this.plugin.settings.recentNotesLimit=parseInt(n),await this.plugin.saveSettings(),this.refreshStartPage()})}),new f.Setting(e).setName(s("pinned_notes_setting")).setDesc(s("pinned_notes_select_desc")).addButton(t=>{t.setButtonText(s("pinned_notes_select")).onClick(()=>{new b(this.app,async n=>{console.log(n),this.plugin.settings.pinnedNotes.includes(n.path)||(this.plugin.settings.pinnedNotes.push(n.path),await this.plugin.saveSettings(),this.refreshStartPage(),this.display())}).open()})}),new f.Setting(e).setName(s("replace_new_tab")).setDesc(s("replace_new_tab_desc")).addToggle(t=>{t.setValue(this.plugin.settings.replaceNewTab),t.onChange(async n=>{this.plugin.settings.replaceNewTab=n,await this.plugin.saveSettings()})}),new f.Setting(e).setName(s("close_other_tabs_when_app_start")).setDesc(s("close_other_tabs_when_app_start_desc")).addToggle(t=>{t.setValue(this.plugin.settings.closeOtherTabsWhenAppStart),t.onChange(async n=>{this.plugin.settings.closeOtherTabsWhenAppStart=n,await this.plugin.saveSettings()})}),this.plugin.settings.pinnedNotes.length>0){new f.Setting(e).setName(s("current_pinned_notes")).setHeading();let t=e.createEl("ul",{cls:"pinned-note-list"});this.plugin.settings.pinnedNotes.forEach((n,a)=>{let o=t.createEl("li",{cls:"pinned-note-item"}),r=this.app.vault.getAbstractFileByPath(n);if(r){o.createEl("span",{text:r.path});let p=o.createEl("div",{cls:"control-buttons"});a>0&&(p.createEl("button",{text:s("move_up"),cls:"control-button"}).onclick=async()=>{await this.moveNote(a,a-1)}),a<this.plugin.settings.pinnedNotes.length-1&&(p.createEl("button",{text:s("move_down"),cls:"control-button"}).onclick=async()=>{await this.moveNote(a,a+1)}),p.createEl("button",{text:s("pinned_notes_remove"),cls:"mod-warning remove-button"}).onclick=async()=>{this.plugin.settings.pinnedNotes=this.plugin.settings.pinnedNotes.filter(c=>c!==n),await this.plugin.saveSettings(),this.refreshStartPage(),this.display()}}})}}};var N=class extends T.Plugin{async onload(){await this.loadSettings();let e=(0,T.getLanguage)()||"en";R(e),this.registerView(d,t=>new g(t,this.app,this)),this.addRibbonIcon("home","Open start page",()=>{this.activateStartPage()}),this.addSettingTab(new C(this.app,this)),this.addCommand({id:"open-start-page",name:s("open_start_page"),callback:()=>{this.activateStartPage()}}),this.addCommand({id:"open-start-page-new-tab",name:s("open_start_page_new_tab"),callback:()=>{this.activateStartPageNewTab()}}),this.registerEvent(this.app.workspace.on("active-leaf-change",t=>{var n;if(this.settings.replaceNewTab&&t&&!t.view.getViewType().startsWith(d)){let a=t.getViewState();a.type==="empty"&&!((n=a.state)!=null&&n.file)&&this.replaceWithStartPage(t)}})),this.registerEvent(this.app.workspace.on("file-menu",(t,n)=>{n instanceof T.TFile&&this.addPinnedNoteMenuItem(t,n)})),this.app.workspace.onLayoutReady(()=>{this.settings.closeOtherTabsWhenAppStart&&this.closeOtherTabs()})}async loadSettings(){this.settings=Object.assign({},D,await this.loadData())}async saveSettings(){await this.saveData(this.settings)}closeOtherTabs(){this.app.workspace.getLeavesOfType("markdown").filter(n=>n.view.getViewType()!==d).forEach(n=>{n.detach()})}findStartPageLeaf(){let e=this.app.workspace.getLeavesOfType(d);return e.length>0?e[0]:null}async activateStartPage(){try{let e=this.app.workspace.getLeaf(!1);e&&await e.setViewState({type:d,active:!0})}catch(e){console.error("Failed to create Start Page leaf:",e)}}async activateStartPageNewTab(){try{let e=this.app.workspace.getLeaf(!0);e&&await e.setViewState({type:d,active:!0})}catch(e){console.error("Failed to create Start Page leaf in new tab:",e)}}async replaceWithStartPage(e){try{await e.setViewState({type:d,active:!0})}catch(t){console.error("Failed to replace with Start Page:",t)}}addPinnedNoteMenuItem(e,t){let n=this.settings.pinnedNotes.includes(t.path);e.addItem(a=>{a.setTitle(n?s("remove_from_pinned_notes"):s("add_to_pinned_notes")).setIcon(n?"pin-off":"pin").onClick(async()=>{n?this.settings.pinnedNotes=this.settings.pinnedNotes.filter(r=>r!==t.path):this.settings.pinnedNotes.push(t.path),await this.saveSettings(),this.app.workspace.getLeavesOfType(d).forEach(r=>{r.view instanceof g&&r.view.renderContent()})})})}onunload(){this.app.workspace.getLeavesOfType(d).forEach(e=>e.detach())}};

/* nosourcemap */